// title_anime.js



window.titleData = {
    test: [

    ],
    
        main: [
            "M191.585549,46.35999c.827923.784413,2.016623,1.23477,3.441449,1.23477,2.855469,0,4.773438-1.767578,4.773438-4.398438,0,0-.008179-4.82444-.02298-9.776695-.006516-2.178951,3.002167-2.761795,3.808762-.737617,2.140259,5.371105,4.37146,10.970367,4.37146,10.970367,1.061035,2.65332,2.869141,3.942383,5.526855,3.942383,2.677734,0,4.430664-1.227539,5.517578-3.863281.00293-.005859.004883-.011719.007812-.017578,0,0,2.29924-5.712208,4.484772-11.142132.81218-2.017832,3.81282-1.431168,3.806229.743973-.015121,4.98925-.023422,9.880581-.023422,9.880581,0,2.589844,1.961914,4.398438,4.771484,4.398438,2.77832,0,4.71875-1.808594,4.71875-4.398438V5.961462c0-1.771466-.753434-3.268899-1.996029-4.237841","M242.245744,45.740145c.624207.771365,1.504823,1.3512,2.53046,1.609501.605957.169922,1.124023.245117,1.680176.245117,1.970215,0,3.541504-1.114258,4.207031-2.983398l3.111687-8.326035c.288437-.771774,1.025749-1.28334,1.849655-1.28334h12.788048c.818932,0,1.552879.505493,1.844849,1.270615l3.205559,8.400284c.676758,1.834961,2.328613,2.974609,4.310547,2.974609.539551,0,1.077637-.083984,1.600586-.250977,2.125977-.56543,3.547363-2.285156,3.547363-4.305664,0-.65625-.12793-1.237305-.402344-1.819336,0,0-14.595215-36.761719-14.595207-36.761719-.563714-1.469863-1.496635-2.560371-2.725578-3.222394M263.138637,18.349845c.324378.211886.594153.528929.755106.950933l1.531372,4.015112c.492989,1.292564-.461586,2.678288-1.844971,2.678288h-3.096222c-.694741,0-1.280837-.349253-1.630178-.860335","M289.832802,44.1034c2.730742,2.371758,6.87089,4.025543,13.354902,4.025543,10.289062,0,17.202148-5.787109,17.202148-14.401367,0-10.114258-7.086914-13.006836-14.746094-14.625488-.005859-.001465-.012695-.002441-.018555-.003906l-3.996094-.808594c-5.672852-1.11377-6.097656-2.643066-6.097656-4.849121,0-2.773438,2.561523-4.429688,6.850586-4.429688,5.039062,0,6.352539,2.375488,6.933594,4.444824.018555.064453.039062.12793.063477.19043.705078,1.854492,2.415039,3.006348,4.462891,3.006348.425781,0,.87793-.051758,1.354492-.152832,2.235352-.445801,3.795898-2.234863,3.795898-4.351562,0-.52002-.095703-1.038086-.28418-1.541992-.814161-2.613143-2.717478-6.344736-7.138554-8.597318","M323.938677,45.741122c.624207.771365,1.504823,1.3512,2.53046,1.609501.605957.169922,1.124023.245117,1.680176.245117,1.970215,0,3.541504-1.114258,4.207031-2.983398l3.111687-8.326035c.288437-.771774,1.025749-1.28334,1.849655-1.28334h12.788048c.818932,0,1.552879.505493,1.844849,1.270615l3.205559,8.400284c.676758,1.834961,2.328613,2.974609,4.310547,2.974609.539551,0,1.077637-.083984,1.600586-.250977,2.125977-.56543,3.547363-2.285156,3.547363-4.305664,0-.65625-.12793-1.237305-.402344-1.819336,0,0-14.595215-36.761719-14.595207-36.761719-.563714-1.469863-1.496635-2.560371-2.725578-3.222394M344.831569,18.350822c.324378.211886.594153.528929.755106.950933l1.531372,4.015112c.492989,1.292564-.461586,2.678288-1.844971,2.678288h-3.096222c-.694741,0-1.280837-.349253-1.630178-.860335","M375.369828,46.367464c.845703.780032,2.052248,1.227299,3.49561,1.227299,2.80957,0,4.771484-1.830078,4.771484-4.451172v-14.058374c0-.389845.115387-.770967.331635-1.095335l13.460358-20.190041c.510742-.718262.791992-1.601562.791992-2.486816h-.000031c0-1.682617-1.013672-3.266114-2.611328-4.114258-2.481445-1.373047-5.085938-.640137-6.379883,1.477051l-7.966028,12.438824","M393.053667,45.740145c.624207.771365,1.504823,1.3512,2.53046,1.609501.605957.169922,1.124023.245117,1.680176.245117,1.970215,0,3.541504-1.114258,4.207031-2.983398l3.111687-8.326035c.288437-.771774,1.025749-1.28334,1.849655-1.28334h12.788048c.818932,0,1.552879.505493,1.844849,1.270615l3.205559,8.400284c.676758,1.834961,2.328613,2.974609,4.310547,2.974609.539551,0,1.077637-.083984,1.600586-.250977,2.125977-.56543,3.547363-2.285156,3.547363-4.305664,0-.65625-.12793-1.237305-.402344-1.819336,0,0-14.595215-36.761719-14.595207-36.761719-.563714-1.469863-1.496635-2.560371-2.725578-3.222394M413.94656,18.349845c.324378.211886.594153.528929.755106.950933l1.531372,4.015112c.492989,1.292564-.461586,2.678288-1.844971,2.678288h-3.096222c-.694741,0-1.280837-.349253-1.630178-.860335","M.350326,46.278113c.84555.830319,2.069136,1.31665,3.517981,1.31665,2.872559,0,4.878417-1.830078,4.878417-4.451172V4.993202c0-1.633886-.738224-2.938835-1.982922-3.703294","M16.516266,46.280098c.853514.829689,2.077281,1.314665,3.522939,1.314665,2.77832,0,4.71875-1.851562,4.71875-4.503906v-12.677734c0-1.090548.884064-1.974611,1.974611-1.974611h5.684568c3.601074,0,4.691895,2.104492,8.671875,12.883791l1.34375,3.44043c.69043,1.773438,2.256348,2.832031,4.189453,2.832031.589355,0,1.225098-.086914,1.734375-.230469,2.074707-.523438,3.46875-2.241211,3.46875-4.273438,0-.555664-.085938-1.05957-.279785-1.632812-.017578-.053711-.037598-.106445-.05957-.158203l-1.325195-3.126953c-2.097076-5.300289-3.632332-9.065868-5.255215-11.6395-.534328-.847357-.290249-1.925806.502205-2.53862,2.924835-2.261812,4.481037-5.713762,4.481037-10.124616,0-4.773742-1.947574-8.47132-5.390611-10.682924M38.742501,10.701049c1.025883.762822,1.49397,2.041673,1.49397,3.922523,0,3.075684-1.997559,4.912109-5.34375,4.912109h-8.160156c-.545272,0-1.038923-.221014-1.396257-.578346","M56.251016,45.740145c.624207.771365,1.504823,1.3512,2.53046,1.609501.605957.169922,1.124023.245117,1.680176.245117,1.970215,0,3.541504-1.114258,4.207031-2.983398l3.111687-8.326035c.288437-.771774,1.025749-1.28334,1.849655-1.28334h12.788048c.818932,0,1.552879.505493,1.844849,1.270615l3.205559,8.400284c.676758,1.834961,2.328613,2.974609,4.310547,2.974609.539551,0,1.077637-.083984,1.600586-.250977,2.125977-.56543,3.547363-2.285156,3.547363-4.305664,0-.65625-.12793-1.237305-.402344-1.819336,0,0-14.595215-36.761719-14.595207-36.761719-.563714-1.469863-1.496635-2.560371-2.725578-3.222394M77.143909,18.349845c.324378.211886.594153.528929.755106.950933l1.531372,4.015112c.492989,1.292564-.461586,2.678288-1.844971,2.678288h-3.096222c-.694741,0-1.280837-.349253-1.630178-.860335","M102.901369,45.261142c1.283081,1.33655,3.203248,2.009403,5.751591,2.009403h13.289551c9.451172,0,15.322266-5.313477,15.322266-13.867188,0-4.0949-1.281143-7.35339-3.702118-9.597292-.747101-.692457-.821823-1.845472-.186523-2.641754,1.618332-2.028425,2.433563-4.662775,2.433563-7.885955,0-4.372007-1.710261-7.752929-4.818104-9.874406M124.870669,10.719751c1.07466.775597,1.287165,1.962188,1.287165,3.20265,0,3.082031-1.70752,4.64502-5.074219,4.64502h-8.640343c-.545423,0-1.039181-.221132-1.39653-.578618M125.536496,28.461935c1.62772,1.072051,1.913819,2.841555,1.913819,4.459,0,2.513672-.693359,5.398438-6.099609,5.398438l-8.910065-.003998c-.545099-.000244-1.038528-.221345-1.395684-.578659","M143.287893,44.826041c1.279015,1.625571,3.339898,2.444504,6.170685,2.444504h20.821289c2.548828,0,4.398438-1.938477,4.398438-4.609375,0-2.682617-1.808594-4.556641-4.398438-4.556641h-17.037598c-1.090546,0-1.974609-.884064-1.974609-1.974609v-6.52734c0-1.090548.884064-1.974611,1.974609-1.974611h14.132324c2.475586,0,4.341797-1.93457,4.341797-4.499512,0-2.643066-1.825684-4.561035-4.341797-4.561035h-14.132324c-1.090546,0-1.974609-.884064-1.974609-1.974611v-4.586423c0-1.090547.884064-1.974611,1.974609-1.974611h16.555176c2.546387,0,4.394531-1.938478,4.394531-4.609375,0-1.147656-.330626-2.147196-.911521-2.915358"],
        sub: [
            "M236.176838,2.164014c-.960397-.748892-2.213005-1.18208-3.635807-1.18208h-.000015c-3.27832,0-5.359375,1.389649-6.552734,4.380372,0,0-6.061737,15.35114-9.206406,23.362274-.655075,1.66881-3.011642,1.672127-3.670609.004854-3.178284-8.041382-9.326599-23.494572-9.326599-23.494572-1.175781-2.901367-3.20459-4.25293-6.384277-4.25293-3.29541,0-5.687012,2.279297-5.687012,5.419922v37.234862c0,1.302895.465008,2.394063,1.277301,3.163668","M266.603706,1.727801c-.910689-.490581-1.983932-.745868-3.189949-.745868-2.766113,0-4.829102,1.409668-5.797363,3.941406l-14.63623,36.752442c-.016602.041016-.031738.083008-.04541.124023-.190918.576172-.275879,1.076172-.275879,1.62207,0,1.024412.367796,1.987301.992001,2.758663M260.258875,25.574235c-.349344-.511086-.461929-1.184004-.209643-1.831325l1.56485-4.015112c.492032-1.262462,1.956563-1.573211,2.929686-.937561","M312.974788,2.449069c-2.308369-1.176137-5.303125-1.949069-9.187618-1.949069-12.22168,0-16.557617,7.208008-16.557617,13.380859,0,9.861328,6.834961,12.600586,13.507812,13.976562l4.324219.919922c6.488281,1.320312,6.973633,3.012695,6.973633,5.443359,0,4.959961-5.902344,5.345703-7.710938,5.345703-6.311523,0-7.554688-2.708984-8.444336-6.013672-.561523-1.97168-2.336914-3.245117-4.523438-3.245117-.460938,0-.835938.063477-1.137695.115234l-.140625.023438c-.051758.008789-.103516.018555-.154297.03125-2.255859.53418-3.770508,2.319336-3.770508,4.443359,0,.416016.072266.762695.130859,1.041992l.021484.104492c.013672.063477.029297.125977.046875.1875.846925,2.859285,2.168679,5.929389,4.885333,8.28891","M348.296638,1.728777c-.910689-.490581-1.983932-.745868-3.189949-.745868-2.766113,0-4.829102,1.409668-5.797363,3.941406l-14.63623,36.752442c-.016602.041016-.031738.083008-.04541.124023-.190918.576172-.275879,1.076172-.275879,1.62207,0,1.024412.367796,1.987301.992001,2.758663M341.951807,25.575212c-.349344-.511086-.461929-1.184004-.209643-1.831325l1.56485-4.015112c.492032-1.262462,1.956563-1.573211,2.929686-.937561","M382.668768,15.555035l-.735571,1.148582c-.776733,1.212851-2.548706,1.212948-3.325562.000179l-8.740387-13.644714c-.915039-1.373535-2.265625-2.129883-3.803711-2.129883-.967773,0-1.8125.325195-2.363281.570312-.0625.027832-.124023.058594-.18457.092285-1.695312.94873-2.708008,2.504395-2.708008,4.161621,0,.754883.195312,1.450195.616211,2.188477.026367.046387.054688.091309.083984.135742l13.603577,20.352952c.217072.324772.332947.706631.332947,1.097267v14.056129c0,1.331052.484861,2.443843,1.330562,3.223872","M417.411629,1.727801c-.910689-.490581-1.983932-.745868-3.189949-.745868-2.766113,0-4.829102,1.409668-5.797363,3.941406l-14.63623,36.752442c-.016602.041016-.031738.083008-.04541.124023-.190918.576172-.275879,1.076172-.275879,1.62207,0,1.024412.367796,1.987301.992001,2.758663M411.066797,25.574235c-.349344-.511086-.461929-1.184004-.209643-1.831325l1.56485-4.015112c.492032-1.262462,1.956563-1.573211,2.929686-.937561","M8.168933,1.7303c-.783675-.481311-1.76812-.748366-2.895496-.748366C2.462891.981934.5,2.8125.5,5.433594v38.15039c0,1.269912.460764,2.354144,1.255457,3.134522","M45.903334,3.627622c-2.342419-1.504631-5.377021-2.321471-8.961439-2.321471h-12.590332c-5.131836,0-7.733398,2.709473-7.733398,8.053223v34.119142c0,1.317936.478955,2.440706,1.303232,3.241975M26.741438,19.397728c-.357337-.357335-.578354-.850989-.578354-1.396265,0,0,0-5.769529.000002-5.769528,0-1.090547.884064-1.974611,1.974611-1.974611h8.48242c1.554725,0,2.715747.280508,3.527514.884119","M80.608978,1.727801c-.910689-.490581-1.983932-.745868-3.189949-.745868-2.766113,0-4.829102,1.409668-5.797363,3.941406l-14.63623,36.752442c-.016602.041016-.031738.083008-.04541.124023-.190918.576172-.275879,1.076172-.275879,1.62207,0,1.024412.367796,1.987301.992001,2.758663M74.264147,25.574235c-.349344-.511086-.461929-1.184004-.209643-1.831325l1.56485-4.015112c.492032-1.262462,1.956563-1.573211,2.929686-.937561","M132.396725,3.844343c-2.417214-1.650039-5.67988-2.538192-9.64088-2.538192h-12.697754c-5.09668,0-7.680664,2.709473-7.680664,8.053223v30.350587c0,2.654783.645995,4.655025,1.929073,5.991573M112.451874,18.429194c-.357352-.35749-.578293-.851337-.578079-1.396763l.001877-4.801268c.000427-1.090246.884361-1.973839,1.974609-1.973839h8.529091c1.905446,0,3.123773.345183,3.896428.902819M112.450088,38.177109c-.357158-.357317-.57804-.850849-.57804-1.39595v-6.900297c0-1.090548.884064-1.974611,1.974609-1.974611h8.804199c1.997356,0,3.362317.384578,4.290771.996078","M174.685586,2.947436c-.777178-1.027723-2.002329-1.641283-3.483011-1.641283h-20.338867c-5.131836,0-7.733398,2.709473-7.733398,8.053222v30.350586c0,2.380743.523047,4.235102,1.562714,5.556473" 
        ]
    };


function initializeTitleAnimation() {
    const container = document.querySelector('.hero-title-container');
    console.log("Container found:", container);

    if (!container) {
        console.error('Hero title container not found!');
        return;
    }

    // テスト用SVG作成関数
    function createTestSVG() {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute('class', 'test-svg svg-debug');
        svg.setAttribute('viewBox', '0 0 400 100');
        svg.setAttribute('width', '100%');
        svg.setAttribute('height', '50px');
        return svg;
    }

    function addTestPaths(svg) {
        titleData.test.forEach((d, i) => {
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute('d', d);
            path.setAttribute('class', 'test-path path-debug');
            path.setAttribute('stroke-width', '2');
            path.setAttribute('fill', 'none');
            
            svg.appendChild(path);
            const length = path.getTotalLength();
            console.log(`Test path ${i} length:`, length);
            
            path.style.strokeDasharray = length;
            path.style.strokeDashoffset = length;

            setTimeout(() => {
                path.style.transition = 'stroke-dashoffset 1s ease-in-out';
                path.style.strokeDashoffset = '0';
            }, i * 500);
        });
    }

    // メインのSVG作成関数
    function createMainSVG(className, width, height) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute('class', `${className} svg-debug`);
        svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
        svg.setAttribute('width', '100%');
        svg.setAttribute('height', '100%');
        return svg;
    }

function addPath(svg, d) {
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute('d', d);
    path.setAttribute('class', 'title-path');
    path.setAttribute('stroke-width', '2.25');
    path.setAttribute('fill', 'none');
    svg.appendChild(path);
    return path;
}

    // 画像要素の作成
    const mainImage = new Image();
    mainImage.src = 'assets/top/title.webp';
    mainImage.className = 'hero-title-main';
    
    const subImage = new Image();
    subImage.src = 'assets/top/title2.webp';
    subImage.className = 'hero-title-rogo';

    // まずテストSVGを追加
    const testSVG = createTestSVG();
    container.appendChild(testSVG);
    addTestPaths(testSVG);

    // 次にメインのタイトルSVGを追加
    const mainSVG = createMainSVG('hero-title-main', 415, 48);
    const subSVG = createMainSVG('hero-title-rogo', 372, 49);

    titleData.main.forEach(path => addPath(mainSVG, path));
    titleData.sub.forEach(path => addPath(subSVG, path));

container.appendChild(mainImage);  
container.appendChild(subImage); 
container.appendChild(mainSVG);   
container.appendChild(subSVG);   

    console.log("All SVGs and images added to container");

    requestAnimationFrame(() => {
        [mainSVG, subSVG].forEach((svg, index) => {
            setTimeout(() => {
                console.log(`Animating title ${index}`);
                svg.classList.add('show');
                
                const paths = svg.querySelectorAll('.title-path');
                paths.forEach((path, pathIndex) => {
                    const length = path.getTotalLength();
                    path.style.strokeDasharray = length;
                    path.style.strokeDashoffset = length;
                    
                    // SVGパスのアニメーション
                    setTimeout(() => {
                        path.style.strokeDashoffset = '0';
                        path.style.opacity = '1';

                        // 最後のパスのアニメーション完了後に画像をフェードイン
                        if (pathIndex === paths.length - 1) {
                            setTimeout(() => {
                                // 対応する画像を表示
                                const img = index === 0 ? mainImage : subImage;
                                img.classList.add('show');

                                // SVGパスをフェードアウト
                                paths.forEach(p => {
                                    p.classList.add('fade-out');
                                });
                            }, 1000); // パス描画完了後のディレイ
                        }
                    }, pathIndex * 20);
                });
            }, index * 75 + 800);
        });
    });
}

// グローバルスコープに関数を公開
window.initializeTitleAnimation = initializeTitleAnimation;